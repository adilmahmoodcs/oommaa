<h1>
  <%= t(@status || :all) %>
  Posts
  (<%= @posts.total_count %>)
</h1>

<%= paginate @posts %>

<table class="table table-hover table-bordered">
  <thead>
    <tr>
      <th>Image</th>
      <th>Message</th>
      <th><%= sort_link(@q, :facebook_page_name, "Page") %></th>
      <th><%= sort_link(@q, :posted_at, "Published at") %></th>
      <th>Actions</th>
    </tr>
  </thead>

  <tbody>
    <% @posts.each do |post| %>
      <tr>
        <td>
          <%= link_to image_tag(post.image_url, width: "150px"),
                      post.permalink,
                      target: "_blank" if post.image_url.present? %>
        </td>
        <td>
          <%= link_to post.message, post.permalink, target: "_blank" %>
        </td>
        <td>
          <%= link_to post.facebook_page.name, post.facebook_page.url, target: "_blank" %>
        </td>
        <td>
          <%= l(post.posted_at, format: :long) %>
        </td>
        <td>
          <% unless @status == "whitelisted" %>
            <%= link_to 'Approve',
                        post_change_status_path(post, :whitelisted),
                        method: :post,
                        class: "btn btn-success" %>
            <br><br>
          <% end %>

          <% unless @status == "blacklisted" %>
          <%= link_to 'Reject',
                      post_change_status_path(post, :blacklisted),
                      method: :post,
                      class: "btn btn-danger" %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= paginate @posts %>
